<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Russell Gray" />
        <meta name="copyright" content="Russell Gray" />

        <link rel="author" href=https://plus.google.com/u/0/102559471807447493728 />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content=", projecteuler, " />

<meta property="og:title" content="Project Euler Problem 5 "/>
<meta property="og:url" content="../drafts/project-euler-problem-5-1.html" />
<meta property="og:description" content="On to the next Project Euler problem (after a bit of a hiatus)... Problem 5 2520 is the smallest number that can be divided by each of the numbers from 1 to 10 without any remainder. What is the smallest number that is evenly divisible by all of the numbers …" />
<meta property="og:site_name" content="Basildon Coder" />
<meta property="og:article:author" content="Russell Gray" />
<meta property="og:article:published_time" content="2008-06-10T12:47:00+01:00" />
<meta name="twitter:title" content="Project Euler Problem 5 ">
<meta name="twitter:description" content="On to the next Project Euler problem (after a bit of a hiatus)... Problem 5 2520 is the smallest number that can be divided by each of the numbers from 1 to 10 without any remainder. What is the smallest number that is evenly divisible by all of the numbers …">

        <title>Project Euler Problem 5  · Basildon Coder
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="../theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="../theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="../theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="../theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <div class="span1"></div>
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="../"><span class=site-name>Basildon Coder</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="..">Home</a></li>
                            <li ><a href="../categories.html">Categories</a></li>
                            <li ><a href="../tags.html">Tags</a></li>
                            <li ><a href="../archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="../search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="../drafts/project-euler-problem-5-1.html"> Project Euler Problem 5  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <p>On to the next Project Euler problem (after a bit of a hiatus)...</p>
<div class="section" id="problem-5">
<h2><a class="reference external" href="http://projecteuler.net/index.php?section=problems&amp;id=5">Problem 5</a></h2>
<blockquote>
<p>2520 is the smallest number that can be divided by each of the
numbers from 1 to 10 without any remainder.</p>
<p>What is the smallest number that is <em>evenly divisible</em> by all of the
numbers from 1 to 20?</p>
</blockquote>
<p>In common with many of the other Euler problems, there's a brute-force
way to solve this, and a clean algorithmic way. And in common with my
other Euler posts so far, I'll start with the brute-force way ;-)</p>
<p>This problem can be tackled head-on with the following approach: Start
from <em>n*=1 and increment in a loop. Test each value of *n</em> by attempting
to divide it by all numbers <em>m</em> from 1 to 20. The first number to pass
the test (i.e. <em>n</em> mod <em>m</em> is 0 for all values of <em>m</em>) is the answer.</p>
<div class="highlight"><pre><span></span><span class="k">private</span> <span class="k">static</span> <span class="kt">long</span> <span class="nf">BruteForceSolver</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">long</span> <span class="n">result</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">result</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="p">!</span><span class="n">Check</span><span class="p">(</span><span class="n">result</span><span class="p">);</span> <span class="p">++</span><span class="n">result</span><span class="p">)</span>
            <span class="p">;</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">Check</span><span class="p">(</span><span class="kt">long</span> <span class="n">result</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="m">20</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">%</span> <span class="n">i</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>This works, but it takes &gt;12 seconds to execute on my PC, so it's not
what you'd call efficient (though it is well within the Euler execution
time guidelines).</p>
<p>Some speed gains can be achieved by exploiting the information provided
in the question itself. We are told that 2520 is the lowest number
evenly divisible by all numbers from 1 to 10. Since the problem space (1
to 20) includes all these numbers, the answer must also be evenly
divisible by 2520. This allows much bigger increments each loop - rather
than incrementing by 1, why not increment by 2520? And since the answer
must be greater than or equal to 2520, why not start the loop there
instead of 1? Finally, since we already know that 1 to 10 divide evenly
into 2520, each inner loop only needs to check numbers 11 to 20.</p>
<p>That should speed things up a bit:</p>
<div class="highlight"><pre><span></span><span class="k">private</span> <span class="kt">long</span> <span class="nf">BruteForceSolver</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">long</span> <span class="n">result</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">result</span> <span class="p">=</span> <span class="m">2520</span><span class="p">;</span> <span class="p">!</span><span class="n">Check</span><span class="p">(</span><span class="n">result</span><span class="p">);</span> <span class="n">result</span> <span class="p">+=</span> <span class="m">2520</span><span class="p">)</span>
        <span class="p">;</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span> <span class="kt">bool</span> <span class="nf">Check</span><span class="p">(</span><span class="kt">long</span> <span class="n">result</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">11</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="m">20</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="p">%</span> <span class="n">i</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>And indeed, on my machine this is now down to 150ms or so. It's still
not a very nice way to tackle the problem, though.</p>
<p>Thinking about it from a different angle yields an altogether smarter
approach. Imagine we are looking for the lowest number evenly divisible
by the numbers 1 to 2.</p>
<div class="math">
\begin{equation*}
[1, 2]
\end{equation*}
</div>
<p>Well that's easy; since there are only two numbers we just find the
lowest common multiple (LCM), which in this case is 2 (since <span class="math">\(2
\bmod 2 = 0\)</span>, and <span class="math">\(2 \bmod 1 = 0\)</span>). If we call this sequence s<sub>1</sub>,
we can say that <span class="math">\(LCM(s_1)=2\)</span>.</p>
<p>OK, now imagine we are solving the same problem for s<sub>2</sub>, which contains
the numbers 1 to 3.</p>
<div class="math">
\begin{equation*}
[1, 2, 3]
\end{equation*}
</div>
<p>You'll notice that s<sub>2</sub> contains s<sub>1</sub> in its entirety. <span class="math">\(LCM(s_2)\)</span>
must therefore be a multiple of <span class="math">\(LCM(s_1)\)</span>, so we can rewrite s<sub>2</sub>
as <span class="math">\([LCM(s_1), 3]\)</span>, or <span class="math">\([2,3]\)</span>). Now we are down to two
numbers again, so we can calculate the LCM of 2 and 3, which is 6, so
<span class="math">\(LCM(s_2)=6\)</span>.</p>
<p>OK, now we solve the problem for the first 4 numbers (s<sub>3</sub>).</p>
<div class="math">
\begin{equation*}
[1, 2, 3, 4]
\end{equation*}
</div>
<p>This sequence contains s<sub>2</sub>, therefore <span class="math">\(LCM(s_3)\)</span> is a multiple of
<span class="math">\(LCM(s_2)\)</span>. We can rewrite s<sub>3</sub> as <span class="math">\([LCM(s_2), 4]\)</span>, or
<span class="math">\([6, 4]\)</span>. Thus, <span class="math">\(LCM(s_3)=12\)</span>.</p>
<p>This can be repeated as many times as necessary. Generally, we have
<span class="math">\(s_n = [LCM(s_{n-1}), n+1]\)</span> where <span class="math">\(n &gt; 0\)</span>.</p>
<p>This looks recursive, but a better way to think of it is as an excellent
example of a fold. A fold is one of the fundamental tools of functional
programming. In fact, it is perhaps the most fundamental, since map,
filter etc can be implemented as right folds <a class="footnote-reference" href="#id4" id="id1">[1]</a>.</p>
<p>I won't inflict my pitiful Photoshop skills on anyone by trying to
graphically represent a fold - try looking at <a class="reference external" href="http://en.wikipedia.org/wiki/Fold_(higher-order_function)">this Wikipedia
article</a> if
you want to try and visualise it.</p>
<p>Broadly, the behaviour of a fold is to apply a combining function to
elements in a list (or other data structure) and accumulate the results.
That's exactly what we want here - our combining function is LCM, and
our accumulating value is the LCM of the whole list. Effectively, for
list s<sub>3</sub> above, we have</p>
<div class="math">
\begin{equation*}
LCM(s_3)=LCM(LCM(LCM(1,2),3),4)=12
\end{equation*}
</div>
<p>Note how the result of the innermost LCM (applied to values 1 and 2)
becomes a parameter to the next LCM, which in turn becomes a parameter
to the outermost LCM which returns the result we want.</p>
<p>By using a fold, we can generalise. In Haskell, the whole problem is a
one-liner:</p>
<div class="highlight"><pre><span></span><span class="nf">foldl</span> <span class="n">lcm</span> <span class="mi">1</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
<p>The 1 passed in as a parameter represents the terminating value to use
when the end of the list is reached. It is common for this value to be
the first element of the list, so Haskell provides a convenience
function that removes the need to specify it as a parameter:</p>
<div class="highlight"><pre><span></span><span class="nf">foldl1</span> <span class="n">lcm</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
<p>Not all languages and platforms provide an LCM function right out of the
box, so to take this neat Haskell solution and port it to .Net, the LCM
function needs to be implemented. This is easily done in terms of the
greatest common divisor (GCD) like so:</p>
<div class="math">
\begin{equation*}
LCM(a, b) = \frac{a\cdot b}{GCD(a, b)}
\end{equation*}
</div>
<p>.Net doesn't provide a GCD function either, so I'll implement it using
<a class="reference external" href="http://en.wikipedia.org/wiki/Euclidean_algorithm">Euclid's Algorithm</a> as an extension method on long ints:</p>
<div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">static</span> <span class="kt">long</span> <span class="nf">GCD</span><span class="p">(</span><span class="k">this</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span> <span class="kt">long</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">b</span> <span class="p">!=</span> <span class="m">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">long</span> <span class="n">tmp</span> <span class="p">=</span> <span class="n">b</span><span class="p">;</span>
        <span class="n">b</span> <span class="p">=</span> <span class="n">a</span> <span class="p">%</span> <span class="n">b</span><span class="p">;</span>
        <span class="n">a</span> <span class="p">=</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>With GCD defined, LCM can be implemented as above:</p>
<div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">static</span> <span class="kt">long</span> <span class="nf">LCM</span><span class="p">(</span><span class="k">this</span> <span class="kt">long</span> <span class="n">a</span><span class="p">,</span> <span class="kt">long</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="p">*</span> <span class="n">b</span><span class="p">)</span> <span class="p">/</span> <span class="n">a</span><span class="p">.</span><span class="n">GCD</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<p>With this in place, it's a simple matter to use .Net's equivalent of
fold - a method on IEnumerable&lt;T&gt; called Aggregate - to get the
answer <a class="footnote-reference" href="#id5" id="id2">[2]</a>:</p>
<div class="highlight"><pre><span></span><span class="k">return</span> <span class="n">LongEnumerable</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">20</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Aggregate</span><span class="p">(</span><span class="m">1L</span><span class="p">,</span> <span class="p">(</span><span class="n">curr</span><span class="p">,</span> <span class="n">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">curr</span><span class="p">.</span><span class="n">LCM</span><span class="p">(</span><span class="n">next</span><span class="p">));</span>
</pre></div>
<p>And indeed, the same basic pattern can be used to solve the problem in a
number of languages. In F#, given implementations of LCM and GCD as
above, we have:</p>
<div class="highlight"><pre><span></span>List.fold_left lcm 1 [1..20]
</pre></div>
<p>And in ruby:</p>
<div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">&#39;rational&#39;</span>
<span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">inject</span> <span class="p">{</span> <span class="o">|</span><span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="o">|</span> <span class="n">c</span><span class="o">.</span><span class="n">lcm</span> <span class="n">n</span> <span class="p">}</span>
</pre></div>
<p>Given that the right algorithm makes this problem a fairly trivial
expression in all these languages, it's pretty hard to identify which is
the nicest. I think overall I'll give the nod to Haskell, however, for
not making me implement LCM and because I find ruby's 'inject' a less
intuitive function name than foldr (but that's probably because I
learned the technique in Haskell in the first place and am set in my
ways...)</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><p class="first">For example, in F#:</p>
<div class="last"><div class="highlight"><pre><span></span>let filter p lst = List.fold_right (fun x xs -&gt; if p x then x::xs else xs) lst []
let map f lst = List.fold_right (fun x xs -&gt; f x :: xs) lst []
</pre></div>
</div></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Note that in this code LongEnumerable is just a very simple partial
reimplementation of Enumerable, using longs instead of ints</td></tr>
</tbody>
</table>
</div>
<script type='text/javascript'>if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2008-06-10T12:47:00+01:00">Jun 10, 2008</time>
            <h4>Category</h4>
            <a class="category-link" href="../categories.html#projecteuler-ref">projecteuler</a>
<h4>Contact</h4>
    <a href="http://twitter.com/russgray" title="My Twitter Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-twitter sidebar-social-links"></i></a>
    <a href="http://github.com/russgray" title="My Github Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-github sidebar-social-links"></i></a>
    <a href="http://uk.linkedin.com/in/russgray/" title="My LinkedIn Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-linkedin sidebar-social-links"></i></a>
    <a href="mailto:russgray@gmail.com" title="My Email Address" class="sidebar-social-links" target="_blank">
    <i class="fa fa-envelope sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="https://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>